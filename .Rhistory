install.packages("shiny")
data <- import(here("data", "flying-etiquette.csv"))
library(rio)
library(rio)
library(here)
library(flexdashboard)
library(rio)
library(here)
data <- import(here("data", "flying-etiquette.csv"))
library(flexdashboard)
library(rio)
library(here)
library(tidyverse)
data <- import(here("data", "flying-etiquette.csv"))
figure_1 <- data %>%
select(starts_with("rude")) %>%
pivot_longer(cols = starts_with("rude"), values_to = "judgment", names_prefix = "rude_", names_to = "type") %>%
filter(judgment != "") %>%
group_by(judgment, type) %>%
count()
figure_1 %>%
ggplot(aes(x= type, y = n, fill = judgment)) +
geom_bar(stat = "identity") +
coord_flip()
n_per_group <- data %>%  select(starts_with("rude")) %>%
pivot_longer(cols = starts_with("rude"), values_to = "judgment", names_prefix = "rude_", names_to = "type") %>%
filter(judgment != "") %>%
count(type) %>%
rename(n_group = n)
figure_1 <- left_join(figure_1, n_per_group, by = "type") %>%
mutate(percent = n/n_group)
figure_1 %>%
ggplot(aes(x= type, y = percent, fill = judgment)) +
geom_bar(stat = "identity") +
coord_flip()
figure_1 <- data %>%
select(starts_with("rude")) %>%
pivot_longer(cols = starts_with("rude"), values_to = "judgment", names_prefix = "rude_", names_to = "type") %>%
mutate(judgment = recode(judgment, "No, not rude at all" = "no",
"Yes, somewhat rude" = "yes",
"Yes, very rude" = "yes")) %>%
filter(judgment == "yes") %>%
count(type)
figure_1 %>%
ggplot(aes(x = n, y = fct_reorder(type, n))) +
geom_col()
